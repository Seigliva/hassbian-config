#!/bin/bash
SUITE_INSTALL_DIR=/opt/hassbian/suites
GITHUBREPO=ludeeus/hassbian-config/master

function install-suite {
   source $SUITE_INSTALL_DIR/install_$1.sh
   $1-install-package
   return 0
}

function upgrade-suite {
   source $SUITE_INSTALL_DIR/upgrade_$1.sh
   $1-upgrade-package
   return 0
}

function suite-upgradeable {
  ONLINEVERSION=$(curl -s https://raw.githubusercontent.com/$GITHUBREPO/package/DEBIAN/control | grep Version | awk '{print $2}')
  LOCALVERSION=$(aptitude show hassbian-scripts | grep Version | awk '{print $2}')
  if [ "$ONLINEVERSION" != "$LOCALVERSION" ]; then
    echo""
    echo "A New version of hassbian-config aviable."
    echo "You have version $LOCALVERSION, and newest is $ONLINEVERSION."
    echo -n "Do you want to upgrade hassbian-config? [y/N]"
    read response
    if [ "$response" == "y" ]; then
      sudo hassbian-config upgrade hassbian-config
    fi
  fi
  return 0
}

if [ $# -lt 1 ]
then
   echo "Wrong command, try again."
   exit
fi
COMMAND=$1
SUITE=$2

case $COMMAND in
"install")
      install-suite $SUITE
   exit
   ;;
"upgrade")
     upgrade-suite $SUITE
  exit
  ;;
*)
   exit
   ;;
esac
